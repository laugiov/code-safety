{% extends 'base.html' %}

{% block title %}VulnShop - Intentionally Vulnerable E-commerce{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12 text-center mb-5">
        <h1 class="display-4">
            Welcome to <span class="text-danger">Vuln</span>Shop
        </h1>
        <p class="lead text-muted">
            An intentionally vulnerable e-commerce application for security testing
            and taint analysis demonstration.
        </p>
        <div class="alert alert-warning d-inline-block">
            <strong>Educational Purpose Only</strong> - Contains 16+ OWASP vulnerabilities
        </div>
    </div>
</div>

<div class="row mb-5">
    <div class="col-md-4">
        <div class="card h-100 border-danger">
            <div class="card-body text-center">
                <h5 class="card-title text-danger">SQL Injection</h5>
                <p class="card-text">
                    V01 & V02: Authentication bypass and data extraction
                    through unsanitized SQL queries.
                </p>
                <a href="{% url 'authentication:login' %}" class="btn btn-outline-danger">Try Login</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card h-100 border-warning">
            <div class="card-body text-center">
                <h5 class="card-title text-warning">XSS</h5>
                <p class="card-text">
                    V03 & V04: Reflected and stored cross-site scripting
                    in search and reviews.
                </p>
                <a href="{% url 'catalog:search' %}" class="btn btn-outline-warning">Try Search</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card h-100 border-info">
            <div class="card-body text-center">
                <h5 class="card-title text-info">Deserialization</h5>
                <p class="card-text">
                    V10: Remote code execution through insecure
                    pickle deserialization in cart.
                </p>
                <a href="{% url 'cart:view_cart' %}" class="btn btn-outline-info">View Cart</a>
            </div>
        </div>
    </div>
</div>

<div class="row mb-5">
    <div class="col-12">
        <h3 class="text-center mb-4">All 16 Vulnerabilities</h3>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Vulnerability</th>
                        <th>CWE</th>
                        <th>OWASP 2021</th>
                        <th>Location</th>
                        <th>Severity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>V01</td>
                        <td>SQL Injection (Auth)</td>
                        <td>CWE-89</td>
                        <td>A03</td>
                        <td>authentication/views.py</td>
                        <td><span class="badge bg-danger">Critical</span></td>
                    </tr>
                    <tr>
                        <td>V02</td>
                        <td>SQL Injection (Search)</td>
                        <td>CWE-89</td>
                        <td>A03</td>
                        <td>catalog/views.py</td>
                        <td><span class="badge bg-danger">High</span></td>
                    </tr>
                    <tr>
                        <td>V03</td>
                        <td>XSS Reflected</td>
                        <td>CWE-79</td>
                        <td>A03</td>
                        <td>catalog/views.py</td>
                        <td><span class="badge bg-warning text-dark">Medium</span></td>
                    </tr>
                    <tr>
                        <td>V04</td>
                        <td>XSS Stored</td>
                        <td>CWE-79</td>
                        <td>A03</td>
                        <td>reviews/views.py</td>
                        <td><span class="badge bg-danger">High</span></td>
                    </tr>
                    <tr>
                        <td>V05</td>
                        <td>Command Injection</td>
                        <td>CWE-78</td>
                        <td>A03</td>
                        <td>admin_panel/views.py</td>
                        <td><span class="badge bg-danger">Critical</span></td>
                    </tr>
                    <tr>
                        <td>V06</td>
                        <td>Path Traversal</td>
                        <td>CWE-22</td>
                        <td>A01</td>
                        <td>admin_panel/views.py</td>
                        <td><span class="badge bg-danger">High</span></td>
                    </tr>
                    <tr>
                        <td>V07</td>
                        <td>IDOR</td>
                        <td>CWE-639</td>
                        <td>A01</td>
                        <td>profile/views.py</td>
                        <td><span class="badge bg-danger">High</span></td>
                    </tr>
                    <tr>
                        <td>V08</td>
                        <td>Mass Assignment</td>
                        <td>CWE-915</td>
                        <td>A04</td>
                        <td>profile/views.py</td>
                        <td><span class="badge bg-danger">High</span></td>
                    </tr>
                    <tr>
                        <td>V09</td>
                        <td>SSRF</td>
                        <td>CWE-918</td>
                        <td>A10</td>
                        <td>webhooks/views.py</td>
                        <td><span class="badge bg-danger">High</span></td>
                    </tr>
                    <tr>
                        <td>V10</td>
                        <td>Insecure Deserialization</td>
                        <td>CWE-502</td>
                        <td>A08</td>
                        <td>cart/views.py</td>
                        <td><span class="badge bg-danger">Critical</span></td>
                    </tr>
                    <tr>
                        <td>V11</td>
                        <td>SSTI</td>
                        <td>CWE-1336</td>
                        <td>A03</td>
                        <td>notifications/views.py</td>
                        <td><span class="badge bg-danger">Critical</span></td>
                    </tr>
                    <tr>
                        <td>V12</td>
                        <td>Hardcoded Secrets</td>
                        <td>CWE-798</td>
                        <td>A02</td>
                        <td>vulnshop/settings.py</td>
                        <td><span class="badge bg-danger">High</span></td>
                    </tr>
                    <tr>
                        <td>V13</td>
                        <td>Vulnerable Dependencies</td>
                        <td>CWE-1035</td>
                        <td>A06</td>
                        <td>requirements.txt</td>
                        <td><span class="badge bg-warning text-dark">Variable</span></td>
                    </tr>
                    <tr>
                        <td>V14</td>
                        <td>Sensitive Data Logging</td>
                        <td>CWE-532</td>
                        <td>A09</td>
                        <td>middleware/logging.py</td>
                        <td><span class="badge bg-warning text-dark">Medium</span></td>
                    </tr>
                    <tr>
                        <td>V15</td>
                        <td>XXE</td>
                        <td>CWE-611</td>
                        <td>A05</td>
                        <td>api/views.py</td>
                        <td><span class="badge bg-danger">High</span></td>
                    </tr>
                    <tr>
                        <td>V16</td>
                        <td>Brute Force</td>
                        <td>CWE-307</td>
                        <td>A07</td>
                        <td>authentication/views.py</td>
                        <td><span class="badge bg-warning text-dark">Medium</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12 text-center">
        <h4>Ready to Test?</h4>
        <a href="{% url 'catalog:product_list' %}" class="btn btn-primary btn-lg me-2">
            Browse Products
        </a>
        <a href="{% url 'authentication:register' %}" class="btn btn-outline-primary btn-lg">
            Create Account
        </a>
    </div>
</div>
{% endblock %}
