{
  "comment": "VulnShop Taint Analysis Configuration - Detects 16 OWASP vulnerabilities",
  "sources": [
    {
      "name": "UserControlled",
      "comment": "Data from HTTP requests (GET, POST, headers, body)"
    },
    {
      "name": "Cookies",
      "comment": "Data from browser cookies"
    },
    {
      "name": "FileSystem",
      "comment": "Data read from files"
    },
    {
      "name": "Environment",
      "comment": "Environment variables"
    },
    {
      "name": "Database",
      "comment": "Data retrieved from database queries"
    },
    {
      "name": "URL",
      "comment": "URL path and query parameters"
    },
    {
      "name": "Headers",
      "comment": "HTTP headers"
    }
  ],
  "sinks": [
    {
      "name": "SQL",
      "comment": "SQL query execution - CWE-89"
    },
    {
      "name": "RemoteCodeExecution",
      "comment": "Code execution through eval/exec/Template - CWE-94"
    },
    {
      "name": "CommandExecution",
      "comment": "OS command execution - CWE-78"
    },
    {
      "name": "FileSystem",
      "comment": "File system operations (open, read, write) - CWE-22"
    },
    {
      "name": "SSRF",
      "comment": "Server-side request forgery - CWE-918"
    },
    {
      "name": "XSS",
      "comment": "Cross-site scripting - CWE-79"
    },
    {
      "name": "Deserialization",
      "comment": "Unsafe deserialization - CWE-502"
    },
    {
      "name": "Logging",
      "comment": "Sensitive data logging - CWE-532"
    },
    {
      "name": "XMLParser",
      "comment": "XML parsing vulnerable to XXE - CWE-611"
    },
    {
      "name": "TemplateInjection",
      "comment": "Server-side template injection - CWE-1336"
    },
    {
      "name": "Redirect",
      "comment": "Open redirect vulnerability - CWE-601"
    }
  ],
  "features": [
    {
      "name": "via_format_string",
      "comment": "Taint propagated through f-strings or .format()"
    },
    {
      "name": "via_concatenation",
      "comment": "Taint propagated through string concatenation"
    },
    {
      "name": "via_dict_access",
      "comment": "Taint propagated through dictionary access"
    },
    {
      "name": "via_base64",
      "comment": "Taint propagated through base64 encoding/decoding"
    },
    {
      "name": "via_json",
      "comment": "Taint propagated through JSON parsing"
    },
    {
      "name": "always_via_request",
      "comment": "Taint always present when from HTTP request"
    }
  ],
  "rules": [
    {
      "name": "SQL Injection",
      "code": 5001,
      "sources": ["UserControlled", "Cookies", "URL"],
      "sinks": ["SQL"],
      "message_format": "SQL Injection (CWE-89): User input from [{$sources}] flows to SQL query [{$sinks}]"
    },
    {
      "name": "Remote Code Execution",
      "code": 5002,
      "sources": ["UserControlled", "Cookies", "FileSystem"],
      "sinks": ["RemoteCodeExecution"],
      "message_format": "RCE (CWE-94): Untrusted data from [{$sources}] reaches code execution [{$sinks}]"
    },
    {
      "name": "Command Injection",
      "code": 5003,
      "sources": ["UserControlled", "URL"],
      "sinks": ["CommandExecution"],
      "message_format": "Command Injection (CWE-78): User input from [{$sources}] flows to OS command [{$sinks}]"
    },
    {
      "name": "Path Traversal",
      "code": 5004,
      "sources": ["UserControlled", "URL"],
      "sinks": ["FileSystem"],
      "message_format": "Path Traversal (CWE-22): User input from [{$sources}] used in file path [{$sinks}]"
    },
    {
      "name": "Server-Side Request Forgery",
      "code": 5005,
      "sources": ["UserControlled", "URL"],
      "sinks": ["SSRF"],
      "message_format": "SSRF (CWE-918): User-controlled URL from [{$sources}] reaches HTTP client [{$sinks}]"
    },
    {
      "name": "Cross-Site Scripting",
      "code": 5006,
      "sources": ["UserControlled", "Database", "URL"],
      "sinks": ["XSS"],
      "message_format": "XSS (CWE-79): Untrusted data from [{$sources}] rendered without escaping [{$sinks}]"
    },
    {
      "name": "Insecure Deserialization",
      "code": 5007,
      "sources": ["UserControlled", "Cookies", "FileSystem"],
      "sinks": ["Deserialization"],
      "message_format": "Insecure Deserialization (CWE-502): Untrusted data from [{$sources}] is deserialized [{$sinks}]"
    },
    {
      "name": "Sensitive Data Logging",
      "code": 5008,
      "sources": ["UserControlled", "Cookies"],
      "sinks": ["Logging"],
      "message_format": "Sensitive Logging (CWE-532): Potentially sensitive data from [{$sources}] is logged [{$sinks}]"
    },
    {
      "name": "XML External Entity Injection",
      "code": 5009,
      "sources": ["UserControlled"],
      "sinks": ["XMLParser"],
      "message_format": "XXE (CWE-611): User-controlled XML from [{$sources}] parsed unsafely [{$sinks}]"
    },
    {
      "name": "Server-Side Template Injection",
      "code": 5010,
      "sources": ["UserControlled"],
      "sinks": ["TemplateInjection"],
      "message_format": "SSTI (CWE-1336): User input from [{$sources}] used in template [{$sinks}]"
    },
    {
      "name": "Open Redirect",
      "code": 5011,
      "sources": ["UserControlled", "URL"],
      "sinks": ["Redirect"],
      "message_format": "Open Redirect (CWE-601): User input from [{$sources}] controls redirect [{$sinks}]"
    }
  ],
  "implicit_sources": {
    "literal_strings": false
  },
  "implicit_sinks": {}
}
