# CVE Reproductions

> Reproductions of real-world vulnerabilities to validate taint analysis tool detection capabilities.

## Overview

This directory contains code patterns that reproduce real Common Vulnerabilities and Exposures (CVEs). These reproductions serve as additional test cases beyond the VulnShop application, validating that our analysis tools can detect vulnerability patterns found in production software.

## CVE Catalog

| CVE ID | Product | Vulnerability Type | Severity | Python Reproduction |
|--------|---------|-------------------|----------|---------------------|
| CVE-2023-36414 | Django | SQL Injection (Trunc/Extract) | High | `cve_2023_36414.py` |
| CVE-2022-34265 | Django | SQL Injection | Critical | `cve_2022_34265.py` |
| CVE-2021-33203 | Django | Path Traversal | Medium | `cve_2021_33203.py` |
| CVE-2021-44228 | Log4j (Pattern) | Expression Injection | Critical | `log4shell_pattern.py` |
| CVE-2020-13942 | Apache Unomi | OGNL Injection | Critical | `ognl_injection_pattern.py` |

## Reproduction Structure

Each CVE reproduction includes:

```
cve_YYYY_NNNNN.py
├── Header documentation
│   ├── CVE ID and description
│   ├── Affected versions
│   ├── CVSS score
│   └── References
├── Vulnerable code pattern
├── Exploit example
├── Fixed code version
└── Taint flow documentation
```

## Usage

### Running All Reproductions Through Analysis

```bash
# Analyze with Pysa
cd analysis/pysa
pyre analyze --source-directories ../../benchmarks/cve-reproductions

# Analyze with CodeQL
cd analysis/codeql
codeql database analyze cve-db vulnshop-security.qls

# Analyze with Semgrep
semgrep --config ../analysis/semgrep/rules benchmarks/cve-reproductions/
```

### Expected Results

| CVE | Pysa | CodeQL | Semgrep |
|-----|:----:|:------:|:-------:|
| CVE-2023-36414 | ✅ | ✅ | ✅ |
| CVE-2022-34265 | ✅ | ✅ | ✅ |
| CVE-2021-33203 | ✅ | ✅ | ✅ |
| Log4Shell Pattern | ✅ | ✅ | ✅ |
| OGNL Injection | ✅ | ✅ | ⚠️ |

## Important Notes

1. **Not Actual Exploits**: These files contain simplified reproductions of vulnerability patterns, not actual exploit code.

2. **Educational Purpose**: All code is for learning and tool validation only.

3. **No External Dependencies**: Reproductions use mock objects where needed to avoid requiring actual vulnerable libraries.

4. **Documented Fixes**: Each reproduction includes the secure implementation pattern.

## Contributing

To add a new CVE reproduction:

1. Create `cve_YYYY_NNNNN.py` with the standard header
2. Include vulnerable and fixed versions
3. Document the taint flow
4. Add to the catalog above
5. Verify detection by all three tools

## References

- [NIST NVD](https://nvd.nist.gov/)
- [Django Security Releases](https://www.djangoproject.com/weblog/security/)
- [MITRE CVE](https://cve.mitre.org/)
- [GitHub Security Advisories](https://github.com/advisories)
